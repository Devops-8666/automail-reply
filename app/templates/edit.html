{% extends "base.html" %}
{% block title %}Edit Reply{% endblock %}
{% block content %}

<h2 class="mb-4">✏️ Edit & Send AI-Generated Reply</h2>

<form method="POST">
  <!-- From -->
  <div class="mb-3">
    <label class="form-label"><strong>From:</strong></label>
    <div class="form-control-plaintext">{{ email.sender }}</div>
  </div>

  <!-- Subject -->
  <div class="mb-3">
    <label class="form-label"><strong>Subject:</strong></label>
    <div class="form-control-plaintext">{{ email.subject }}</div>
  </div>

  <!-- Original Message -->
  <div class="mb-3">
    <label class="form-label"><strong>Original Message:</strong></label>
    <div class="border rounded p-3 bg-light" style="white-space: pre-wrap;">{{ email.body }}</div>
  </div>

  <!-- Reply Text Area -->
  <div class="mb-3">
    <label for="reply" class="form-label"><strong>AI Suggested Reply (You can edit):</strong></label>
    <textarea class="form-control" name="reply" id="reply" rows="8" required>{{ email.reply or '' }}</textarea>
  </div>

  <!-- Live Preview -->
  <div class="mb-3">
    <label class="form-label"><strong>Reply Preview:</strong></label>
    <div id="preview" class="border rounded p-3 bg-white" style="white-space: pre-wrap;"></div>
  </div>

  <!-- Buttons -->
  <div class="d-flex gap-3">
    <button type="submit" class="btn btn-success">✅ Send Reply</button>
    <a href="/inbox" class="btn btn-outline-secondary">↩ Back to Inbox</a>
  </div>
</form>

<!-- JavaScript for live preview -->
<script>
  const replyBox = document.getElementById("reply");
  const preview = document.getElementById("preview");

  replyBox.addEventListener("input", () => {
    preview.textContent = replyBox.value;
  });

  // Show preview on page load
  preview.textContent = replyBox.value;
</script>

{% endblock %}

